---
layout: base.njk
title: Task Board ‚Äî Kanban
permalink: /admin/tasks/
---

<style>
  :root {
    --bg-dark: #0f172a;
    --bg-card: #1e293b;
    --bg-column: #1a2234;
    --border: #334155;
    --text: #f8fafc;
    --text-muted: #94a3b8;
    --red: #ef4444;
    --orange: #f97316;
    --green: #22c55e;
    --blue: #3b82f6;
    --purple: #a855f7;
    --yellow: #eab308;
  }

  * { box-sizing: border-box; }

  body {
    background: var(--bg-dark);
    color: var(--text);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    margin: 0;
    padding: 0;
  }

  .admin-nav {
    display: flex;
    justify-content: center;
    gap: 0;
    background: var(--bg-card);
    border-bottom: 2px solid var(--border);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .admin-nav a {
    color: var(--text-muted);
    font-size: 15px;
    font-weight: 600;
    padding: 14px 28px;
    text-decoration: none;
    border-bottom: 3px solid transparent;
    transition: all 0.2s;
  }

  .admin-nav a:hover {
    color: var(--text);
    background: rgba(255,255,255,0.05);
  }

  .admin-nav a.active {
    color: #10b981;
    border-bottom-color: #10b981;
  }

  .board-header {
    padding: 1.5rem 2rem 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .board-title {
    font-size: 1.75rem;
    font-weight: 800;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .board-stats {
    display: flex;
    gap: 1.5rem;
    font-size: 0.9rem;
  }

  .stat {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .stat-num {
    font-weight: 800;
    font-size: 1.25rem;
  }

  .stat-label {
    color: var(--text-muted);
  }

  .board-actions {
    display: flex;
    gap: 0.75rem;
  }

  .btn {
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    border: 2px solid var(--border);
    background: var(--bg-card);
    color: var(--text);
    transition: all 0.2s;
  }

  .btn:hover {
    background: var(--border);
  }

  .btn-primary {
    background: var(--green);
    border-color: var(--green);
    color: #000;
  }

  .btn-primary:hover {
    background: #16a34a;
  }

  /* KANBAN BOARD */
  .kanban-board {
    display: flex;
    gap: 1rem;
    padding: 1rem 2rem 2rem;
    overflow-x: auto;
    min-height: calc(100vh - 160px);
    align-items: flex-start;
  }

  .kanban-column {
    flex: 0 0 320px;
    background: var(--bg-column);
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    max-height: calc(100vh - 180px);
  }

  .column-header {
    padding: 1rem 1.25rem;
    font-weight: 700;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 2px solid var(--border);
    position: sticky;
    top: 0;
    background: var(--bg-column);
    border-radius: 12px 12px 0 0;
    z-index: 10;
  }

  .column-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .column-count {
    background: var(--border);
    padding: 0.2rem 0.6rem;
    border-radius: 999px;
    font-size: 0.75rem;
    font-weight: 700;
  }

  .column-header.backlog { border-left: 4px solid var(--text-muted); }
  .column-header.in-progress { border-left: 4px solid var(--blue); }
  .column-header.done { border-left: 4px solid var(--green); }

  .column-cards {
    flex: 1;
    overflow-y: auto;
    padding: 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
  }

  .column-cards.drag-over {
    background: rgba(59, 130, 246, 0.1);
  }

  /* TASK CARDS */
  .task-card {
    background: var(--bg-card);
    border-radius: 10px;
    padding: 0.9rem 1rem;
    cursor: grab;
    border: 2px solid transparent;
    transition: all 0.15s;
    position: relative;
  }

  .task-card:hover {
    border-color: var(--border);
    transform: translateY(-1px);
  }

  .task-card.dragging {
    opacity: 0.5;
    transform: rotate(2deg);
  }

  .task-card.drag-preview {
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    border-color: var(--blue);
  }

  .card-priority {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    border-radius: 10px 10px 0 0;
  }

  .card-priority.urgent { background: var(--red); }
  .card-priority.money { background: var(--orange); }
  .card-priority.later { background: var(--green); }
  .card-priority.nice { background: var(--text-muted); }

  .card-labels {
    display: flex;
    gap: 0.4rem;
    margin-bottom: 0.6rem;
    flex-wrap: wrap;
  }

  .card-label {
    font-size: 0.65rem;
    font-weight: 700;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  .label-urgent { background: rgba(239, 68, 68, 0.2); color: var(--red); }
  .label-money { background: rgba(249, 115, 22, 0.2); color: var(--orange); }
  .label-later { background: rgba(34, 197, 94, 0.2); color: var(--green); }
  .label-nice { background: rgba(148, 163, 184, 0.2); color: var(--text-muted); }

  .label-robspain { background: rgba(59, 130, 246, 0.2); color: var(--blue); }
  .label-behaviorschool { background: rgba(168, 85, 247, 0.2); color: var(--purple); }
  .label-ios { background: rgba(234, 179, 8, 0.2); color: var(--yellow); }

  .card-title {
    font-size: 0.9rem;
    font-weight: 600;
    line-height: 1.4;
    margin-bottom: 0.6rem;
    color: var(--text);
  }

  .card-meta {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  .card-time {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  .card-due {
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-weight: 600;
    font-size: 0.7rem;
  }

  .card-due.overdue { background: rgba(239, 68, 68, 0.2); color: var(--red); }
  .card-due.today { background: rgba(249, 115, 22, 0.2); color: var(--orange); }
  .card-due.soon { background: rgba(234, 179, 8, 0.2); color: var(--yellow); }
  .card-due.future { background: rgba(148, 163, 184, 0.1); color: var(--text-muted); }

  /* CARD EXPANDED STATE */
  .task-card.expanded {
    border-color: var(--blue);
  }

  .card-details {
    display: none;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
  }

  .task-card.expanded .card-details {
    display: block;
  }

  .card-details h4 {
    font-size: 0.8rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
    color: var(--text-muted);
  }

  .card-details ol {
    margin: 0;
    padding-left: 1.25rem;
    font-size: 0.8rem;
    line-height: 1.6;
    color: var(--text);
  }

  .card-details li {
    margin-bottom: 0.4rem;
  }

  .card-details a {
    color: var(--blue);
    text-decoration: none;
  }

  .card-details a:hover {
    text-decoration: underline;
  }

  .card-details code {
    background: var(--bg-dark);
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-size: 0.75rem;
    color: var(--orange);
  }

  /* ADD CARD BUTTON */
  .add-card-btn {
    width: 100%;
    padding: 0.6rem;
    background: transparent;
    border: 2px dashed var(--border);
    border-radius: 8px;
    color: var(--text-muted);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    margin-top: 0.5rem;
  }

  .add-card-btn:hover {
    border-color: var(--text-muted);
    color: var(--text);
  }

  /* QUICK FILTERS */
  .filter-bar {
    padding: 0 2rem 0.5rem;
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .filter-chip {
    padding: 0.4rem 0.9rem;
    border-radius: 999px;
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    border: 2px solid var(--border);
    background: transparent;
    color: var(--text-muted);
    transition: all 0.2s;
  }

  .filter-chip:hover {
    border-color: var(--text-muted);
    color: var(--text);
  }

  .filter-chip.active {
    background: var(--blue);
    border-color: var(--blue);
    color: #fff;
  }

  /* MODAL */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    padding: 2rem;
  }

  .modal-overlay.show {
    display: flex;
  }

  .modal {
    background: var(--bg-card);
    border-radius: 16px;
    width: 100%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  }

  .modal-header {
    padding: 1.25rem 1.5rem;
    border-bottom: 2px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .modal-title {
    font-size: 1.1rem;
    font-weight: 700;
  }

  .modal-close {
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    line-height: 1;
  }

  .modal-body {
    padding: 1.5rem;
  }

  .form-group {
    margin-bottom: 1.25rem;
  }

  .form-label {
    display: block;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
  }

  .form-input,
  .form-textarea,
  .form-select {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid var(--border);
    border-radius: 8px;
    background: var(--bg-dark);
    color: var(--text);
    font-size: 0.95rem;
    transition: border-color 0.2s;
  }

  .form-input:focus,
  .form-textarea:focus,
  .form-select:focus {
    outline: none;
    border-color: var(--blue);
  }

  .form-textarea {
    min-height: 100px;
    resize: vertical;
    font-family: inherit;
  }

  .modal-footer {
    padding: 1rem 1.5rem;
    border-top: 2px solid var(--border);
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
  }

  /* Responsive */
  @media (max-width: 900px) {
    .kanban-board {
      padding: 1rem;
    }
    
    .kanban-column {
      flex: 0 0 280px;
    }
    
    .board-header {
      padding: 1rem;
    }
  }

  @media (max-width: 600px) {
    .board-stats {
      display: none;
    }
    
    .kanban-column {
      flex: 0 0 85vw;
    }
  }
</style>

<nav class="admin-nav">
  <a href="/admin/tasks/" class="active">üìã Tasks</a>
  <a href="/admin/agents/">ü§ñ Agents</a>
  <a href="/admin/crm/">üë• CRM</a>
  <a href="/admin/seo/">üìä SEO</a>
</nav>

<header class="board-header">
  <h1 class="board-title">üìã Task Board</h1>
  <div class="board-stats">
    <div class="stat">
      <span class="stat-num" id="stat-total">0</span>
      <span class="stat-label">Total</span>
    </div>
    <div class="stat">
      <span class="stat-num" id="stat-progress" style="color: var(--blue)">0</span>
      <span class="stat-label">In Progress</span>
    </div>
    <div class="stat">
      <span class="stat-num" id="stat-done" style="color: var(--green)">0</span>
      <span class="stat-label">Done</span>
    </div>
  </div>
  <div class="board-actions">
    <button class="btn" onclick="resetFilters()">üîÑ Reset</button>
    <button class="btn btn-primary" onclick="openAddModal()">+ Add Task</button>
  </div>
</header>

<div class="filter-bar">
  <button class="filter-chip active" data-filter="all">All</button>
  <button class="filter-chip" data-filter="urgent">üî¥ Urgent</button>
  <button class="filter-chip" data-filter="money">üü° Money</button>
  <button class="filter-chip" data-filter="later">üü¢ Later</button>
  <button class="filter-chip" data-filter="nice">‚ö™ Nice</button>
</div>

<div class="kanban-board">
  <div class="kanban-column">
    <div class="column-header backlog">
      <span class="column-title">üì• Backlog <span class="column-count" id="count-backlog">0</span></span>
    </div>
    <div class="column-cards" id="col-backlog" data-status="not-started"></div>
  </div>

  <div class="kanban-column">
    <div class="column-header in-progress">
      <span class="column-title">üîÑ In Progress <span class="column-count" id="count-progress">0</span></span>
    </div>
    <div class="column-cards" id="col-progress" data-status="in-progress"></div>
  </div>

  <div class="kanban-column">
    <div class="column-header done">
      <span class="column-title">‚úÖ Done <span class="column-count" id="count-done">0</span></span>
    </div>
    <div class="column-cards" id="col-done" data-status="done"></div>
  </div>
</div>

<!-- Add/Edit Modal -->
<div class="modal-overlay" id="task-modal">
  <div class="modal">
    <div class="modal-header">
      <span class="modal-title" id="modal-title">Add Task</span>
      <button class="modal-close" onclick="closeModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Title</label>
        <input type="text" class="form-input" id="task-title-input" placeholder="What needs to be done?">
      </div>
      <div class="form-group">
        <label class="form-label">Category</label>
        <select class="form-select" id="task-category-input">
          <option value="urgent">üî¥ Urgent</option>
          <option value="money">üü° Makes Money</option>
          <option value="later">üü¢ Later</option>
          <option value="nice">‚ö™ Nice to Have</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Platform</label>
        <select class="form-select" id="task-platform-input">
          <option value="robspain.com">robspain.com</option>
          <option value="behaviorschool.com">behaviorschool.com</option>
          <option value="iOS App">iOS App</option>
          <option value="BAE SIG">BAE SIG</option>
          <option value="Other">Other</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Time Estimate</label>
        <input type="text" class="form-input" id="task-time-input" placeholder="e.g. 15 min">
      </div>
      <div class="form-group">
        <label class="form-label">Due Date</label>
        <input type="date" class="form-input" id="task-due-input">
      </div>
      <div class="form-group">
        <label class="form-label">Instructions (one per line)</label>
        <textarea class="form-textarea" id="task-instructions-input" placeholder="Step 1&#10;Step 2&#10;Step 3"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn" onclick="closeModal()">Cancel</button>
      <button class="btn btn-primary" onclick="saveTask()">Save Task</button>
    </div>
  </div>
</div>

<script>
  let tasks = [
    // üî¥ URGENT
    {
      id: 1,
      category: 'urgent',
      title: 'Review CALABA Symposium: "Beyond Observable Behavior"',
      platform: 'behaviorschool.com',
      time: '25 min',
      dueDate: '2026-03-07',
      status: 'not-started',
      priority: true,
      instructions: [
        'Go to <a href="https://behaviorschool.com/admin/presentations" target="_blank">behaviorschool.com/admin/presentations</a>',
        'Find "Beyond Observable Behavior" in Library',
        'Symposium team: you (Chair+Presenter), Cristal Lopez, Megan Caluza (Discussant)',
        'Click "Present" to preview',
        'Verify all content is accurate',
        'Export PPTX backup',
        'Practice your section (5-10 min talk track)'
      ]
    },
    {
      id: 2,
      category: 'urgent',
      title: 'Review PBIS Presentation: "BCBAs in PBIS"',
      platform: 'behaviorschool.com',
      time: '20 min',
      dueDate: '2026-03-05',
      status: 'not-started',
      priority: true,
      instructions: [
        'Go to <a href="https://behaviorschool.com/admin/presentations" target="_blank">behaviorschool.com/admin/presentations</a>',
        'Find "BCBAs in PBIS" in the Library',
        'Panel with Megan Caluza, Holly Northcross, Katie Turner',
        'Click "Present" to preview ‚Äî check content accuracy',
        'Export PPTX backup'
      ]
    },
    {
      id: 3,
      category: 'urgent',
      title: 'Review 9 Writer Drafts',
      platform: 'Both sites',
      time: '30 min',
      dueDate: null,
      status: 'not-started',
      priority: true,
      instructions: [
        'Ask Neo on Telegram to send preview links',
        '9 drafts ready: Grad School, Mock Scores, Burnout Series, Supervision posts, LinkedIn, YouTube script, more',
        'Sort each into robspain.com (thought leadership) or behaviorschool.com (SEO/products)',
        'Reply "approved" or send feedback per draft'
      ]
    },
    {
      id: 4,
      category: 'urgent',
      title: 'Set up app.behaviorschool.com DNS',
      platform: 'behaviorschool.com',
      time: '3 min',
      dueDate: null,
      status: 'not-started',
      priority: true,
      instructions: [
        'All signup buttons on <a href="https://behaviorschool.com/pro" target="_blank">behaviorschool.com/pro</a> point to app.behaviorschool.com (dead link!)',
        'Go to <a href="https://dcc.godaddy.com/manage/behaviorschool.com/dns" target="_blank">GoDaddy DNS Manager</a> ‚Üí behaviorschool.com',
        'Add CNAME record: Name = app, Value = cname.vercel-dns.com, TTL default',
        'Tell Neo when done'
      ]
    },
    
    // üü° MAKES MONEY
    {
      id: 5,
      category: 'money',
      title: 'Apple Sign-In Setup (App Store Blocker)',
      platform: 'iOS App',
      time: '15 min',
      dueDate: null,
      status: 'not-started',
      priority: true,
      instructions: [
        'Go to <a href="https://developer.apple.com/account/resources/identifiers/list/serviceId" target="_blank">developer.apple.com Service IDs</a>',
        'Click + ‚Üí Description: "Behavior Study Tools Sign In"',
        'Identifier: "com.behaviorschool.studytools.signin"',
        'Enable "Sign In with Apple" ‚Üí Configure',
        'Add domain: study.behaviorschool.com',
        'Add return URL: https://study.behaviorschool.com/auth/callback ‚Üí Save',
        'Go to <a href="https://developer.apple.com/account/resources/authkeys/list" target="_blank">Keys</a> ‚Üí New key ‚Üí Enable "Sign In with Apple"',
        'Download .p8 file ‚Üí Send Neo: Team ID, Service ID, Key ID, and .p8 file'
      ]
    },
    {
      id: 6,
      category: 'money',
      title: 'Get PayPal Link from Liz (Raffle Go-Live)',
      platform: 'BAE SIG',
      time: '2 min',
      dueDate: null,
      status: 'not-started',
      priority: true,
      instructions: [
        'Text or email Liz Flaherty',
        'Ask for the PayPal QR/link earmarked "SIG Reception Donation"',
        'Send the link to Neo ‚Äî raffle site goes live immediately',
        'Current site: <a href="https://calaba-sig-raffle.vercel.app" target="_blank">calaba-sig-raffle.vercel.app</a>'
      ]
    },
    {
      id: 7,
      category: 'money',
      title: 'Gmail App Password for BAE SIG Email',
      platform: 'BAE SIG',
      time: '3 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Go to <a href="https://myaccount.google.com/apppasswords" target="_blank">Google App Passwords</a>',
        'Sign in as california.bae.sig@gmail.com',
        'Generate an app password',
        'Send it to Neo ‚Äî enables auto-emailing raffle tickets'
      ]
    },
    {
      id: 8,
      category: 'money',
      title: 'Auth Gmail for Neo (Email + Calendar Access)',
      platform: 'robspain.com',
      time: '3 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'When home at Mac mini, open Terminal',
        'Run: <code>GOG_KEYRING_BACKEND=file gog auth add robspain@gmail.com --services gmail,calendar,drive,contacts,docs,sheets</code>',
        'Browser will open ‚Äî sign in and approve',
        'Unlocks: email monitoring, calendar checks, custody project, email campaigns'
      ]
    },

    // üü¢ LATER
    {
      id: 9,
      category: 'later',
      title: 'Record Video #1: "5 Ethics Questions That Trip Everyone Up"',
      platform: 'behaviorschool.com',
      time: '30 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Script ready ‚Äî ask Neo for it or view at behaviorschool.com/admin/videos',
        'Record on phone (vertical = social, horizontal = YouTube)',
        'Upload to behaviorschool.com/admin/videos',
        'Neo cuts it into short clips automatically'
      ]
    },
    {
      id: 10,
      category: 'later',
      title: 'Record Videos #2-5 (Reinforcement, Design, FBA, Study Strategy)',
      platform: 'behaviorschool.com',
      time: '2 hrs',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        '4 more scripts ready ‚Äî all at behaviorschool.com/admin/videos',
        'Record when you have creative energy',
        'Neo handles editing + social clips'
      ]
    },
    {
      id: 11,
      category: 'later',
      title: 'Review Marketing Calendar',
      platform: 'behaviorschool.com',
      time: '15 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Go to <a href="https://behaviorschool.com/admin/content-calendar" target="_blank">behaviorschool.com/admin/content-calendar</a>',
        'Review 13 draft posts (pre-scheduled)',
        'Approve, edit, or reschedule as needed'
      ]
    },
    {
      id: 12,
      category: 'later',
      title: 'Add Testimonials to Both Sites',
      platform: 'Both sites',
      time: '15 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Think of 3-5 people who\'ve used your tools or training',
        'Get permission for quotes',
        'Send Neo: name, role, quote ‚Äî he adds them to both sites'
      ]
    },
    {
      id: 13,
      category: 'later',
      title: 'Share Social Media Logins',
      platform: 'Both sites',
      time: '5 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Share Instagram, LinkedIn, Facebook, YouTube logins with Neo',
        'Enables agents to post approved content directly',
        'Nothing goes out without your approval'
      ]
    },
    {
      id: 14,
      category: 'later',
      title: 'Share Ahrefs Login',
      platform: 'SEO',
      time: '2 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Share Ahrefs credentials with Neo',
        'SEO agent will run keyword gap analysis + competitor tracking',
        'First target: IEP Goal Writer page optimization'
      ]
    },

    // ‚ö™ NICE
    {
      id: 15,
      category: 'nice',
      title: 'Tell Me About Email Auth Bug',
      platform: 'study.behaviorschool.com',
      time: '5 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'What happens when users try to log in with email on study.behaviorschool.com?',
        'Not receiving emails? Redirect loop? Error message?',
        'Screenshot if possible ‚Äî message Neo the details'
      ]
    },
    {
      id: 16,
      category: 'nice',
      title: 'Set Cloudflare R2 Environment Variables',
      platform: 'behaviorschool.com',
      time: '5 min',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        'Go to <a href="https://app.netlify.com" target="_blank">Netlify Dashboard</a> ‚Üí behaviorschool.com ‚Üí Site Settings ‚Üí Environment Variables',
        'Copy R2 keys from learning platform: CF_R2_ACCESS_KEY_ID, CF_R2_SECRET_ACCESS_KEY, CF_R2_BUCKET_NAME, CF_R2_PUBLIC_BASE_URL, CF_R2_ACCOUNT_ID'
      ]
    },
    {
      id: 17,
      category: 'nice',
      title: 'Record Training Videos for robspain.com',
      platform: 'robspain.com',
      time: '2 hrs',
      dueDate: null,
      status: 'not-started',
      priority: false,
      instructions: [
        '"Crisis Manager to Systems Leader" 10-part series',
        'Each video 5-10 minutes ‚Äî record at your own pace',
        'Upload to admin panel when ready'
      ]
    }
  ];

  let activeFilter = 'all';
  let editingTaskId = null;

  // Load saved states
  function loadTaskStates() {
    const saved = localStorage.getItem('robKanbanTasks');
    if (saved) {
      const states = JSON.parse(saved);
      tasks.forEach(task => {
        if (states[task.id]) {
          task.status = states[task.id].status || task.status;
          task.dueDate = states[task.id].dueDate ?? task.dueDate;
        }
      });
    }
  }

  function saveTaskStates() {
    const states = {};
    tasks.forEach(task => {
      states[task.id] = { status: task.status, dueDate: task.dueDate };
    });
    localStorage.setItem('robKanbanTasks', JSON.stringify(states));
  }

  // Due date formatting
  function formatDue(dateStr) {
    if (!dateStr) return null;
    const d = new Date(dateStr + 'T00:00:00');
    const today = new Date(); today.setHours(0,0,0,0);
    const diff = Math.round((d - today) / 86400000);
    
    if (diff < 0) return { text: 'Overdue', class: 'overdue' };
    if (diff === 0) return { text: 'Today', class: 'today' };
    if (diff === 1) return { text: 'Tomorrow', class: 'soon' };
    if (diff <= 7) return { text: d.toLocaleDateString('en-US', {weekday: 'short'}), class: 'soon' };
    return { text: d.toLocaleDateString('en-US', {month: 'short', day: 'numeric'}), class: 'future' };
  }

  // Get platform label class
  function getPlatformClass(platform) {
    if (platform.includes('robspain')) return 'label-robspain';
    if (platform.includes('behaviorschool')) return 'label-behaviorschool';
    if (platform.includes('iOS')) return 'label-ios';
    return '';
  }

  // Render a card
  function renderCard(task) {
    const due = formatDue(task.dueDate);
    const platformClass = getPlatformClass(task.platform);
    
    const card = document.createElement('div');
    card.className = 'task-card';
    card.draggable = true;
    card.dataset.id = task.id;
    
    card.innerHTML = `
      <div class="card-priority ${task.category}"></div>
      <div class="card-labels">
        <span class="card-label label-${task.category}">${task.category}</span>
        ${platformClass ? `<span class="card-label ${platformClass}">${task.platform}</span>` : ''}
      </div>
      <div class="card-title">${task.title}</div>
      <div class="card-meta">
        <span class="card-time">‚è±Ô∏è ${task.time}</span>
        ${due ? `<span class="card-due ${due.class}">${due.text}</span>` : ''}
      </div>
      <div class="card-details">
        <h4>Instructions:</h4>
        <ol>${task.instructions.map(i => `<li>${i}</li>`).join('')}</ol>
      </div>
    `;

    // Click to expand
    card.addEventListener('click', (e) => {
      if (e.target.closest('a')) return;
      card.classList.toggle('expanded');
    });

    // Drag events
    card.addEventListener('dragstart', handleDragStart);
    card.addEventListener('dragend', handleDragEnd);

    return card;
  }

  // Render board
  function renderBoard() {
    const cols = {
      'not-started': document.getElementById('col-backlog'),
      'in-progress': document.getElementById('col-progress'),
      'done': document.getElementById('col-done')
    };

    Object.values(cols).forEach(col => col.innerHTML = '');

    const filtered = activeFilter === 'all' 
      ? tasks 
      : tasks.filter(t => t.category === activeFilter);

    filtered.forEach(task => {
      const col = cols[task.status];
      if (col) col.appendChild(renderCard(task));
    });

    // Update counts
    document.getElementById('count-backlog').textContent = 
      filtered.filter(t => t.status === 'not-started').length;
    document.getElementById('count-progress').textContent = 
      filtered.filter(t => t.status === 'in-progress').length;
    document.getElementById('count-done').textContent = 
      filtered.filter(t => t.status === 'done').length;

    // Stats
    document.getElementById('stat-total').textContent = tasks.length;
    document.getElementById('stat-progress').textContent = 
      tasks.filter(t => t.status === 'in-progress').length;
    document.getElementById('stat-done').textContent = 
      tasks.filter(t => t.status === 'done').length;
  }

  // Drag & Drop
  let draggedCard = null;

  function handleDragStart(e) {
    draggedCard = e.target;
    e.target.classList.add('dragging');
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/plain', e.target.dataset.id);
  }

  function handleDragEnd(e) {
    e.target.classList.remove('dragging');
    document.querySelectorAll('.column-cards').forEach(col => {
      col.classList.remove('drag-over');
    });
    draggedCard = null;
  }

  // Setup drop zones
  document.querySelectorAll('.column-cards').forEach(col => {
    col.addEventListener('dragover', (e) => {
      e.preventDefault();
      col.classList.add('drag-over');
    });

    col.addEventListener('dragleave', () => {
      col.classList.remove('drag-over');
    });

    col.addEventListener('drop', (e) => {
      e.preventDefault();
      col.classList.remove('drag-over');
      
      const taskId = parseInt(e.dataTransfer.getData('text/plain'));
      const newStatus = col.dataset.status;
      
      const task = tasks.find(t => t.id === taskId);
      if (task) {
        task.status = newStatus;
        saveTaskStates();
        renderBoard();
      }
    });
  });

  // Filter chips
  document.querySelectorAll('.filter-chip').forEach(chip => {
    chip.addEventListener('click', () => {
      document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
      chip.classList.add('active');
      activeFilter = chip.dataset.filter;
      renderBoard();
    });
  });

  function resetFilters() {
    activeFilter = 'all';
    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
    document.querySelector('[data-filter="all"]').classList.add('active');
    renderBoard();
  }

  // Modal
  function openAddModal() {
    editingTaskId = null;
    document.getElementById('modal-title').textContent = 'Add Task';
    document.getElementById('task-title-input').value = '';
    document.getElementById('task-category-input').value = 'urgent';
    document.getElementById('task-platform-input').value = 'behaviorschool.com';
    document.getElementById('task-time-input').value = '';
    document.getElementById('task-due-input').value = '';
    document.getElementById('task-instructions-input').value = '';
    document.getElementById('task-modal').classList.add('show');
  }

  function closeModal() {
    document.getElementById('task-modal').classList.remove('show');
  }

  function saveTask() {
    const title = document.getElementById('task-title-input').value.trim();
    if (!title) {
      alert('Please enter a task title');
      return;
    }

    const newTask = {
      id: editingTaskId || Date.now(),
      title,
      category: document.getElementById('task-category-input').value,
      platform: document.getElementById('task-platform-input').value,
      time: document.getElementById('task-time-input').value || '15 min',
      dueDate: document.getElementById('task-due-input').value || null,
      status: 'not-started',
      priority: document.getElementById('task-category-input').value === 'urgent',
      instructions: document.getElementById('task-instructions-input').value
        .split('\n')
        .filter(l => l.trim())
    };

    if (editingTaskId) {
      const idx = tasks.findIndex(t => t.id === editingTaskId);
      if (idx >= 0) tasks[idx] = { ...tasks[idx], ...newTask };
    } else {
      tasks.unshift(newTask);
    }

    saveTaskStates();
    renderBoard();
    closeModal();
  }

  // Close modal on overlay click
  document.getElementById('task-modal').addEventListener('click', (e) => {
    if (e.target === e.currentTarget) closeModal();
  });

  // Init
  document.addEventListener('DOMContentLoaded', () => {
    loadTaskStates();
    renderBoard();
  });
</script>
